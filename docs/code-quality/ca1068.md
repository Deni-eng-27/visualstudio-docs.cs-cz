---
title: 'CA1068: parametry CancellationToken se musí nacházet jako poslední.'
ms.date: 09/16/2019
ms.topic: reference
f1_keywords:
- CA1068
- CancellationTokenParametersMustComeLast
helpviewer_keywords:
- CA1068
- CancellationTokenParametersMustComeLast
author: mavasani
ms.author: mavasani
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 9b952060620f5c4243eaecab617dd0e2415684d3
ms.sourcegitcommit: 8589d85cc10710ef87e6363a2effa5ee5610d46a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/23/2019
ms.locfileid: "72806190"
---
# <a name="ca1068-cancellationtoken-parameters-must-come-last"></a>CA1068: parametry CancellationToken se musí nacházet jako poslední.

|||
|-|-|
|TypeName|CancellationTokenParametersMustComeLast|
|CheckId|CA1068|
|Kategorie|Microsoft. Design|
|Zásadní změna|Narušující|

## <a name="cause"></a>příčina

Metoda má parametr <xref:System.Threading.CancellationToken>, který není posledním parametrem.

## <a name="rule-description"></a>Popis pravidla

Metody, které provádějí dlouhodobě běžící operace nebo asynchronní operace a jsou porušitelné normálně pobírají parametr tokenu zrušení. Každý token zrušení má <xref:System.Threading.CancellationTokenSource>, který vytvoří token a použije ho pro zrušení výpočtů. Je běžné, že máte dlouhé řetězce volání metod, která přecházejí na token zrušení od volajících do volané. Proto je velký počet metod, které se účastní v rámci zrušení výpočtu, končí parametrem tokenu zrušení. Samotný token zrušení však není obvykle relevantní pro základní funkce většiny těchto metod. Považuje se za dobrý postup návrhu rozhraní API, který by měl mít jako poslední parametr v seznamu.

### <a name="special-cases"></a>Zvláštní případy
Pravidlo CA1068 se neaktivuje v následujících zvláštních případech:
- Metoda má jeden nebo více [volitelných](/dotnet/csharp/programming-guide/classes-and-structs/named-and-optional-arguments#optional-arguments) parametrů ([volitelné](/dotnet/visual-basic/programming-guide/language-features/procedures/optional-parameters) v Visual Basic) po nepovinném parametru zrušení tokenu. Kompilátor vyžaduje, aby všechny volitelné parametry byly definovány po všech nevolitelných parametrech.
- Metoda má jeden nebo více parametrů [ref](/dotnet/csharp/language-reference/keywords/ref) nebo [out](/dotnet/csharp/language-reference/keywords/out-parameter-modifier) ([ByRef](/dotnet/visual-basic/language-reference/modifiers/byref) v Visual Basic) za parametrem tokenu zrušení. Je běžné, že jsou parametry `ref` nebo `out` na konci seznamu, protože obvykle označují výstupní hodnoty pro metodu.

> [!NOTE]
> Pravidlo CA1068 není k dispozici v analýze starší verze. Byla poprvé zavedena v [analyzátorech FxCop](https://www.nuget.org/packages/Microsoft.CodeAnalysis.FxCopAnalyzers).

## <a name="how-to-fix-violations"></a>Jak opravit porušení

Změňte signaturu metody pro přesunutí parametru zrušení tokenu na konec seznamu. Například následující dva fragmenty kódu ukazují porušení pravidla a jejich opravu:

```csharp
// Violates CA1068
public void LongRunningOperation(CancellationToken token, string usefulParameter)
{
    ...
}
```

```csharp
// Does not violate CA1068
public void LongRunningOperation(string usefulParameter, CancellationToken token)
{
    ...
}
```

## <a name="when-to-suppress-warnings"></a>Kdy potlačit upozornění

Pokud je metoda externě viditelným veřejným rozhraním API, které už je součástí dodávané knihovny, je bezpečné potlačit upozornění od tohoto pravidla, abyste se vyhnuli zásadní změně pro příjemce knihovny.

## <a name="configurability"></a>Konfigurovatelnost

[Roslyn analyzátory vystaví 2851](https://github.com/dotnet/roslyn-analyzers/issues/2851) sleduje, jak se pravidlo v balíčku [FxCopAnalyzers](https://www.nuget.org/packages/Microsoft.CodeAnalysis.FxCopAnalyzers) dá konfigurovat. Po jeho implementaci můžete nakonfigurovat plochu rozhraní API, na které se pravidlo spouští, aby nedocházelo k použití potlačení zdrojů.

## <a name="related-rules"></a>Související pravidla

- [CA1021: Vyhněte se výstupním parametrům](../code-quality/ca1021.md)
- [CA1025: Nahraďte opakované argumenty polem parametrů](../code-quality/ca1025.md)
- [CA1026: Neměly by být použity výchozí parametry](../code-quality/ca1026.md)

## <a name="see-also"></a>Viz také:

- [Doporučené vzory pro CancellationToken](https://devblogs.microsoft.com/premier-developer/recommended-patterns-for-cancellationtoken/)
