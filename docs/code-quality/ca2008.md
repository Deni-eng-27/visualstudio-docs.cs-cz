---
title: 'CA2008: Nevytvářejte úlohy bez předávání TaskScheduler'
ms.date: 08/26/2020
ms.topic: reference
f1_keywords:
- CA2008
- DoNotCreateTasksWithoutPassingATaskSchedulerAnalyzer
helpviewer_keywords:
- CA2008
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: bfca9695bb3f350ab497365dc05352da193606b0
ms.sourcegitcommit: 26178b116cbf7353fee6ca989b8d872114f7b405
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/31/2020
ms.locfileid: "89220952"
---
# <a name="ca2008-do-not-create-tasks-without-passing-a-taskscheduler"></a>CA2008: Nevytvářejte úlohy bez předávání TaskScheduler

|Položka|Hodnota|
|-|-|
|CheckId|CA2008|
|Kategorie|Microsoft.Reliability|
|Zásadní změna|Nenarušující|

## <a name="cause"></a>Příčina

Operace vytvoření nebo pokračování úlohy používá přetížení metody, které neurčuje <xref:System.Threading.Tasks.TaskScheduler> parametr.

## <a name="rule-description"></a>Popis pravidla

Následující metody vytváření a pokračování úlohy v .NET Framework mají přetížení, které umožňují zadání nebo vynechání <xref:System.Threading.Tasks.TaskScheduler> instance:
- <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=fullName> způsobů 
- <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=fullName> způsobů

Vždy specifikujte explicitní <xref:System.Threading.Tasks.TaskScheduler> argument, aby nedošlo k výchozí <xref:System.Threading.Tasks.TaskScheduler.Current%2A> hodnotě, jejíž chování je definováno volajícím a může se lišit za běhu. <xref:System.Threading.Tasks.TaskScheduler.Current%2A> Vrátí Scheduler přidružený k libovolnému <xref:System.Threading.Tasks.Task> aktuálně spuštěnému vláknu. Pokud taková úloha neexistuje, vrátí <xref:System.Threading.Tasks.TaskScheduler.Default%2A> , která představuje fond vláken. Použití <xref:System.Threading.Tasks.TaskScheduler.Current%2A> by mohlo vést k zablokování nebo problémům s odezvou uživatelského rozhraní v některých situacích, kdy bylo zamýšleno k vytvoření úlohy ve fondu vláken, ale místo toho čeká na návrat do vlákna uživatelského rozhraní.

Další informace a podrobné příklady najdete v [tomto článku](https://devblogs.microsoft.com/pfxteam/new-taskcreationoptions-and-taskcontinuationoptions-in-net-4-5/).

> [!NOTE]
> [VSTHRD105 – Vyhněte se přetížením metod, které předpokládají TaskScheduler. Current](https://github.com/microsoft/vs-threading/blob/master/doc/analyzers/VSTHRD105.md) je podobné pravidlo implementované v balíčku [Microsoft. VisualStudio. Threading. analyzers](https://www.nuget.org/packages/Microsoft.VisualStudio.Threading.Analyzers) .

## <a name="how-to-fix-violations"></a>Jak opravit porušení

Chcete-li opravit porušení, zavolejte přetížení metody, které přijímá <xref:System.Threading.Tasks.TaskScheduler> a explicitně předává <xref:System.Threading.Tasks.TaskScheduler.Default%2A> nebo <xref:System.Threading.Tasks.TaskScheduler.Current%2A> , aby záměr byl jasný.

## <a name="when-to-suppress-warnings"></a>Kdy potlačit upozornění

Toto upozornění je určené hlavně pro knihovny, kde kód může být spuštěn v libovolném prostředí a kde kód by neměl vytvářet předpoklady pro prostředí nebo způsob, jakým volající metoda může vystavit nebo čekat na něj. Může být vhodné potlačit upozornění pro projekty, které reprezentují kód aplikace namísto kódu knihovny.

## <a name="see-also"></a>Viz také

- [Nové parametr TaskCreationOptions a typ TaskContinuationOptions v .NET 4,5](https://devblogs.microsoft.com/pfxteam/new-taskcreationoptions-and-taskcontinuationoptions-in-net-4-5/)
- [VSTHRD105 – Vyhněte se přetížením metod, které předpokládají TaskScheduler. Current](https://github.com/microsoft/vs-threading/blob/master/doc/analyzers/VSTHRD105.md)
- [CA2007: Nečekejte přímo na úlohu](ca2007.md)
- [Upozornění spolehlivosti](reliability-warnings.md)
