---
title: 'CA1021: Vyhněte se výstupním parametrům'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1021
- AvoidOutParameters
helpviewer_keywords:
- AvoidOutParameters
- CA1021
ms.assetid: 970f2304-842c-4fb7-9734-f3871da8d479
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 579b04f26af972ac025b0bfc07bc8dc9eb636d12
ms.sourcegitcommit: 98421670ed0b8170aaa32d3d6f8681298f401a1d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/18/2020
ms.locfileid: "81638029"
---
# <a name="ca1021-avoid-out-parameters"></a>CA1021: Vyhněte se výstupním parametrům

|||
|-|-|
|TypeName|AvoidOutParameters|
|CheckId|CA1021|
|Kategorie|Microsoft.Design|
|Narušující změny|Narušující|

## <a name="cause"></a>Příčina
Veřejná nebo chráněná metoda ve `out` veřejném typu má parametr.

Ve výchozím nastavení se toto pravidlo dívá pouze na externě viditelné typy, ale toto je [konfigurovatelné](#configurability).

## <a name="rule-description"></a>Popis pravidla
Předávání typů odkazem `out` `ref`(pomocí nebo ) vyžaduje zkušenosti s ukazateli, pochopení, jak se liší typy hodnot a typy odkazů, a zpracování metod s více návratovými hodnotami. Také rozdíl mezi `out` `ref` a parametry není široce pochopen.

Pokud je typ odkazu předán "odkazem", metoda má v úmyslu použít parametr k vrácení jiné instance objektu. Předávání typu odkazu odkazem je také známé jako použití dvojitého ukazatele, ukazatele na ukazatel nebo dvojité houštiny. Pomocí výchozí konvence volání, která je předat "podle hodnoty", parametr, který přebírá typ odkazu již obdrží ukazatel na objekt. Ukazatel, nikoli objekt, na který odkazuje, je předán hodnotou. Předat hodnotou znamená, že metoda nemůže změnit ukazatel tak, aby odkazoval na novou instanci typu odkazu. Však může změnit obsah objektu, na který odkazuje. Pro většinu aplikací je to dostačující a dává požadované chování.

Pokud metoda musí vrátit jinou instanci, použijte vrácenou hodnotu metody k dosažení tohoto cíle. Viz <xref:System.String?displayProperty=fullName> třídy pro různé metody, které pracují na řetězce a vrátit novou instanci řetězce. Při použití tohoto modelu musí volající rozhodnout, zda je původní objekt zachován.

Přestože vrácené hodnoty jsou běžné a silně `out` `ref` používané, správné použití a parametry vyžaduje zprostředkující návrh a kódování dovednosti. Architekti knihovny, kteří navrhují pro širokou `out` publikum, by neměli očekávat, že uživatelé budou pracovat s parametry nebo `ref` parametry.

## <a name="how-to-fix-violations"></a>Jak opravit porušení
Chcete-li opravit porušení tohoto pravidla, které je způsobeno typem hodnoty, musí metoda vrátit objekt jako jeho vrácená hodnota. Pokud metoda musí vrátit více hodnot, redesign to vrátit jednu instanci objektu, který obsahuje hodnoty.

Chcete-li opravit porušení tohoto pravidla, které je způsobeno typem odkazu, ujistěte se, že požadované chování je vrátit novou instanci odkazu. Pokud je, metoda by měla použít jeho vrácená hodnota k tomu.

## <a name="when-to-suppress-warnings"></a>Kdy potlačit varování
Je bezpečné potlačit upozornění z tohoto pravidla. Tento návrh však může způsobit problémy s použitelností.

## <a name="configurability"></a>Konfigurovatelnost

Pokud používáte toto pravidlo z [analyzátorů FxCop](install-fxcop-analyzers.md) (a ne s analýzou starší verze), můžete nakonfigurovat, na které části vašeho základu kódu chcete toto pravidlo spustit, na základě jejich usnadnění přístupu. Chcete-li například určit, že pravidlo by mělo být spuštěno pouze proti neveřejnému povrchu rozhraní API, přidejte do souboru .editorconfig v projektu následující dvojici klíč-hodnota:

```ini
dotnet_code_quality.ca1021.api_surface = private, internal
```

Tuto možnost můžete nakonfigurovat pouze pro toto pravidlo, pro všechna pravidla nebo pro všechna pravidla v této kategorii (Návrh). Další informace naleznete v [tématu Konfigurace analyzátorů FxCop](configure-fxcop-analyzers.md).

## <a name="example"></a>Příklad
Následující knihovna zobrazuje dvě implementace třídy, která generuje odpovědi na zpětnou vazbu uživatele. První implementace`BadRefAndOut`( ) vynutí, aby uživatel knihovny spravoval tři vrácené hodnoty. Druhá implementace`RedesignedRefAndOut`( ) zjednodušuje uživatelské prostředí vrácením instance`ReplyData`třídy kontejneru ( ), která spravuje data jako jednu jednotku.

[!code-csharp[FxCop.Design.NoRefOrOut#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_1.cs)]

## <a name="example"></a>Příklad
Následující aplikace ilustruje zkušenosti uživatele. Volání přepracované knihovny`UseTheSimplifiedClass` (metoda) je jednodušší a informace vrácené metodou lze snadno spravovat. Výstup z obou metod je identický.

[!code-csharp[FxCop.Design.TestNoRefOrOut#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_2.cs)]

## <a name="example"></a>Příklad
Následující příklad knihovny `ref` ukazuje, jak se používají parametry pro typy odkazů a ukazuje lepší způsob, jak implementovat tuto funkci.

[!code-csharp[FxCop.Design.RefByRefNo#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_3.cs)]

## <a name="example"></a>Příklad
Následující aplikace volá každou metodu v knihovně k předvedení chování.

[!code-csharp[FxCop.Design.TestRefByRefNo#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_4.cs)]

Tento příklad vytváří následující výstup:

```txt
Changing pointer - passed by value:
12345
12345
Changing pointer - passed by reference:
12345
12345 ABCDE
Passing by return value:
12345 ABCDE
```

## <a name="try-pattern-methods"></a>Vyzkoušet metody vzor

### <a name="description"></a>Popis
Metody, které implementují **Try\<** <xref:System.Int32.TryParse%2A?displayProperty=fullName>Something>vzor, například , nevyvolávají toto porušení. Následující příklad ukazuje strukturu (typ hodnoty), <xref:System.Int32.TryParse%2A?displayProperty=fullName> která implementuje metodu.

### <a name="code"></a>kód
[!code-csharp[FxCop.Design.TryPattern#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_5.cs)]

## <a name="related-rules"></a>Související pravidla
[CA1045: Nepředávejte typy odkazem](../code-quality/ca1045.md)
