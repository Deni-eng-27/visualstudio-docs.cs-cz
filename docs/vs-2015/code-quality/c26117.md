---
title: C26117 | Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-code-analysis
ms.topic: reference
f1_keywords:
- C26117
helpviewer_keywords:
- C26117
ms.assetid: cc7ebc8d-9826-4cad-a4d5-2d3ad5896734
caps.latest.revision: 13
author: corob-msft
ms.author: corob
manager: jillfra
ms.openlocfilehash: ff941f72cc15c318fe84e6f6dd673f297bf66233
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/02/2020
ms.locfileid: "77266536"
---
# <a name="c26117"></a>C26117
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Upozornění C26117: uvolňování nedrženého zámku \<lock> ve funkci \<func> .

V rámci tohoto jazyka není provedeno vynucování *dvojic s* syntakticky vymezenými zámky a zámky *verzí* v programech C/C++. Funkce může zavést vedlejší efekt uzamčení tím, že provede pozorovatelnou úpravu stavu souběžnosti. Například funkce uzamknout obálka zvyšuje počet pořizování zámků nebo počet zámků pro daný zámek. Funkci, která má vedlejší účinek z zámku, můžete opatřit pomocí `_Acquires_lock_` nebo v `_Releases_lock_` uvedeném pořadí. Bez takovýchto poznámek se očekává, že funkce nemění počet zámků poté, co se vrátí. Pokud získání a vydání nejsou vyvážené, považují se za *osamocené*. Upozornění C26117 se vydá, když funkce, která není poznámkou, `_Releases_lock_` uvolní zámek, který neobsahuje, protože funkce musí před vydáním zámku vlastnit zámek.

## <a name="example"></a>Příklad
Následující příklad generuje upozornění C26117, protože funkce `ReleaseUnheldLock` uvolní zámek, který nutně nedrží – stav `flag` je nejednoznačný – a neexistuje žádná poznámka, která určuje, zda by měla.

```cpp

typedef struct _DATA
{
    CRITICAL_SECTION cs;
} DATA;

int flag;

void ReleaseUnheldLock(DATA* p)
{
    if (flag)
        EnterCriticalSection(&p->cs);
    // code ...
    LeaveCriticalSection(&p->cs);
}
```

## <a name="example"></a>Příklad
Následující kód opraví problém tím, že zaručí, že vydaný zámek je také získaný za stejných podmínek.

```cpp

typedef struct _DATA
{
    CRITICAL_SECTION cs;
} DATA;

int flag;

void ReleaseUnheldLock(DATA* p)
{
    if (flag)
    {
        EnterCriticalSection(&p->cs);
        // code ...
        LeaveCriticalSection(&p->cs);
    }
}
```

## <a name="see-also"></a>Viz také
[C26115](../code-quality/c26115.md)
