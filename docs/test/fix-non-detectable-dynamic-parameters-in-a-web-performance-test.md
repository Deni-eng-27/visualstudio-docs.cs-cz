---
title: Oprava nezjistitelných dynamických parametrů v testu výkonu webu
ms.date: 10/19/2016
ms.topic: conceptual
helpviewer_keywords:
- walkthroughs, load tests
- load tests, walkthroughs
- load tests, correlating dynamic parameters
ms.assetid: 92dff25c-36ee-4135-acdd-315c4962fa11
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: b4328c5b71fa7023ec9c2ab68ae6725f5855ada5
ms.sourcegitcommit: cc841df335d1d22d281871fe41e74238d2fc52a6
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/18/2020
ms.locfileid: "75589640"
---
# <a name="fix-non-detectable-dynamic-parameters-in-a-web-performance-test"></a>Oprava nedetekovatelných dynamických parametrů v testu výkonnosti webu

Některé weby používají dynamické parametry ke zpracování některých svých webových požadavků. Dynamický parametr je parametr, jehož hodnota je znovu generována při každém spuštění aplikace uživatelem. Příkladem dynamického parametru je ID relace. ID relace se obvykle mění každých 5 až 30 minut. Webový záznamník testu výkonu a přehrávací modul automaticky zpracovává nejběžnější typy dynamických parametrů:

- Hodnoty dynamických parametrů, které jsou nastaveny v hodnotě souboru cookie. Webový výkon testovací modul automaticky zpracovává tyto během přehrávání.

- Hodnoty dynamických parametrů, které jsou nastaveny ve skrytých polích na stránkách HTML, například ASP.NET stavu zobrazení. Ty jsou automaticky zpracovány rekordérem, který přidává do testu skrytá pravidla extrakce pole.

- Hodnoty dynamických parametrů, které jsou nastaveny jako parametry řetězce dotazu nebo příspěvku formuláře. Ty jsou zpracovány prostřednictvím dynamické detekce parametrů po zaznamenání testu výkonu webu.

Některé typy dynamických parametrů nejsou rozpoznány. Nezjištěný dynamický parametr způsobí selhání testu výkonu webu při jeho spuštění, protože dynamická hodnota se bude lišit při každém spuštění testu. Chcete-li správně zpracovat tyto parametry, můžete ručně přidat pravidla extrakce k dynamickým parametrům v testech výkonu webu.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

## <a name="create-and-run-a-web-app-with-dynamic-parameters"></a>Vytvoření a spuštění webové aplikace s dynamickými parametry

Chcete-li demonstrovat zjistitelné a nezjistitelné dynamický parametr, vytvoříme jednoduchou ASP.NET webovou aplikaci, která má tři webové formuláře s několika ovládacími prvky a některé vlastní kód. Pak se naučíme, jak izolovat dynamické parametry a jak s nimi zacházet.

1. Vytvořte nový projekt ASP.NET s názvem **DynamicParameterSample**.

     ![Vytvoření prázdného projektu webové aplikace ASP.NET](../test/media/web_test_dynamicparameter_aspproject.png)

2. Přidejte webový formulář s názvem *Querystring.aspx*.

3. V návrhovém zobrazení přetáhněte HiddenField na stránku a potom změňte hodnotu vlastnosti (ID) na HiddenFieldSessionID.

     ![Přidání hiddenfieldu](../test/media/web_test_dynamicparameter_hiddenfield.png)

4. Změňte na zdrojové zobrazení stránky Querystring a přidejte následující zvýrazněný ASP.NET a kód Jazyka JavaScript, který slouží ke generování dynamických parametrů mock session ID:

    ```html
    <head runat="server">
    <title>JavaScript dynamic property correlation sample</title><script type="text/javascript" language="javascript">    <!--        function jScriptQueryString()         {            var Hidden = document.getElementById("HiddenFieldSessionID");            var sessionId = Hidden.value;            window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;         }    //--></script>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>
             <a name="QuerystringHyperlink" href="ASPQuery.aspx?CustomQueryString=ASPQueryString___<%= Session.SessionID %>">Dynamic querystring generated by ASP.net</a>         <br/>         <br/>         <a href="javascript:jScriptQueryString()">Dynamic querystring generated by javascript </a>
        </div>
        <asp:HiddenField ID="HiddenFieldSessionID" runat="server" />
        </form>
    </body>
    </html>
    ```

5. Otevřete *soubor Querystring.aspx.cs* a do Page_Load metody přidejte následující zvýrazněný kód:

    ```csharp
    public partial class Querystring : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Session.Add("Key", "Value");HiddenFieldSessionID.Value = Session.SessionID;
        }
    }
    ```

6. Přidejte druhý webový formulář s názvem *ASPQuery.aspx*.

7. V návrhovém zobrazení přetáhněte **popisek** na stránku a změňte hodnotu vlastnosti **(ID)** na **IndexLabel**.

     ![Přidání popisku do webového formuláře](../test/media/web_test_dynamicparameter_label.png)

8. Přetáhněte **hypertextový odkaz** na stránku a změňte pole pro vlastnost **Text** na **Zpět**.

     ![Přidání hypertextového odkazu do webového formuláře](../test/media/web_test_dynamicparameter_hyperlink.png)

9. Zvolte **(...)** pro vlastnost **NavigationURL.**

     ![Úprava vlastnosti NavigateURL](../test/media/web_test_dynamicparameter_hyperlink_navurl.png)

     Vyberte *soubor Querystring.aspx*.

     ![Zvolte adresu URL, která má být Querystring.aspx](../test/media/web_test_dynamicparameter_hyperlink_navurl2.png)

10. Otevřete *soubor ASPQuery.aspx.cs* a do Page_Load metody přidejte následující zvýrazněný kód:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

11. Přidejte třetí webový formulář s názvem *JScriptQuery.aspx*.

     Stejně jako jsme to udělali pro druhou stránku, přetáhněte **label** do formuláře, nastavení jeho **vlastnosti (ID)** na **IndexLabel** a přetáhněte **hypertextový odkaz** na formulář, nastavení jeho **Vlastnost Text** **zpět**a jeho **Vlastnost NavigationURL** na **Querystring.aspx**.

     ![Přidání a konfigurace třetího webového formuláře](../test/media/web_test_dynamicparameter_addwebform3.png)

12. Otevřete *soubor JScriptQuery.aspx.cs* a přidejte do Page_Load metody následující zvýrazněný kód:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

13. Uložte projekt.

14. V **Průzkumníku řešení**nastavte jako úvodní stránku *soubor Querystring.aspx.*

     ![Nastavení úvodní stránky na souboru Querystring.aspx](../test/media/web_test_dynamicparameter_setstartpage.png)

15. Stisknutím **klávesy Ctrl**+**F5** spusťte webovou aplikaci v prohlížeči. Zkopírujte adresu URL. Budete ji potřebovat při nahrávání testu.

16. Zkuste oba odkazy. Každý z nich by měl zobrazit zprávu "Úspěch. Byl nalezen parametr dynamického řetězce dotazu."

     ![Spuštění webové aplikace](../test/media/web_test_dynamicparameter_runapp.png)

     ![Úspěch&#33;](../test/media/web_test_dynamicparameter_runapp2.png)

## <a name="create-a-web-performance-test"></a>Vytvoření testu výkonu webu

1. Přidejte do svého řešení webový výkon a projekt zátěžového testu.

     ![Přidání projektu perfromance webu a zátěžového testu](../test/media/web_test_dynamicparameter_addtestproject.png)

2. Přejmenujte webTest1.webtest na DynamicParameterSampleApp.webtest.

     ![Přejmenování testu výkonu webu](../test/media/web_test_dynamicparameter_renametest.png)

3. Zaznamenejte test.

     ![Záznam testu výkonu webu](../test/media/web_test_dynamicparameter_recordtest.png)

4. Zkopírujte a vložte adresu URL z webového webu, který testujete, do prohlížeče.

     ![Vložení adresy URL z testovaného webu](../test/media/web_test_dynamicparameter_recordtest2.png)

5. Procházet webové aplikace. Zvolte odkaz ASP.NET, odkaz Zpět a potom odkaz javascript, následovaný zpětným odkazem.

     Webový testovací záznamník zobrazuje adresy URL požadavků a odpovědí HTTP při procházení webové aplikace.

6. Zvolte tlačítko **Stop** na testovacím rekordéru.

     Dialogové okno pro zjišťování dynamických parametrů zobrazuje indikátor průběhu, který zobrazuje stav detekce parametrů v přijatých odpovědích HTTP.

7. Dynamický parametr pro CustomQueryString na stránce ASPQuery je automaticky rozpoznán. Dynamický parametr pro CustomQueryString na stránce JScriptQuery však nebyl rozpoznán.

     Zvolte **OK,** chcete-li přidat pravidlo extrakce do *souboru Querystring.aspx*, vazby na stránku ASPQuery.

     ![Povýšení detekovaného dynamického parametru](../test/media/web_test_dynamicparameter_promotedialog.png)

     Pravidlo extrakce je přidáno k prvnímu požadavku na *soubor Querystring.aspx*.

     ![Pravidlo extrakce přidané do požadavku](../test/media/web_test_dynamicparameter_autoextractionrule.png)

     Rozbalte druhý požadavek ve stromu požadavků pro *ASPQuery.aspx* a všimněte si, že hodnota CustomQueryString byla vázána na pravidlo extrakce.

     ![Pravidlo extrakce vázaný na customquerystring vázaný na pravidlo extrakce](../test/media/web_test_dynamicparameter_autoextractionrule2.png)

8. Uložte test.

## <a name="run-the-test-to-isolate-the-non-detected-dynamic-parameter"></a>Spuštěnítestu k izolace nezjištěného dynamického parametru

1. Spusťte test.

     ![Spuštění testu výkonu webu](../test/media/web_test_dynamicparameter_runtest.png)

2. Čtvrtý požadavek na stránku *JScriptQuery.aspx* se nezdaří. Přejděte na webový test.

     ![Chyba dynamického parametru ve výsledcích testu](../test/media/web_test_dynamicparameter_runresults.png)

     Uzel požadavku *JScriptQuery.aspx* je zvýrazněn v editoru. Rozbalte uzel a všimněte si, že část "1v0yhyiyr0raa2w4j4pwf5zl" customquerystring se zdá být dynamická.

     ![Podezřelý dynamický parametr v řetězci CustomQueryString](../test/media/web_test_dynamicparameter_runresults2.png)

3. Vraťte se do prohlížeče výsledků testů výkonnosti webu a vyberte stránku *JScriptQuery.aspx,* která se nezdařila. Potom zvolte kartu požadavku, ověřte, zda je zaškrtnuté políčko Zobrazit nezpracovaná data, posuňte se dolů a zvolte rychlé hledání na CustomQueryString.

     ![Použití rychlého hledání k oddálení dynamického parametru](../test/media/web_test_dynamicparameter_runresultsquckfind.png)

4. Víme, že z pohledu na editor testu, že *JScriptQuery.aspx* požadavku CustomQueryString byla přiřazena hodnota: `jScriptQueryString___1v0yhyiyr0raa2w4j4pwf5zl`, a že podezření na dynamickou část je "1v0yhyiyr0raa2w4j4pwf5zl". V seznamu najít, co rozevírací seznam, odeberte podezřelou část vyhledávacího řetězce. Řetězec by měl být "CustomQueryString=jScriptQueryString___".

     Dynamické parametry jsou přiřazeny jejich hodnoty v jednom z požadavků, které předchází požadavek, který má chybu. Proto zaškrtněte políčko Hledat až a zvolte najít další, dokud se v panelu požadavku nezobrazí předchozí požadavek na *soubor Querystring.aspx.* K tomu by mělo dojít po výběru najít další třikrát.

     ![Použití rychlého hledání k oddálení dynamického parametru](../test/media/web_test_dynamicparameter_runresultsquckfind4.png)

     Jak je znázorněno na kartě odpovědi a v JavaScriptu implementovaném výše, parametr řetězce dotazu CustomQueryString je přiřazena hodnota "jScriptQueryString___" a je také zřetězena s vrácenou hodnotou z var sessionId.

    ```javascript
    function jScriptQueryString()          {             var Hidden = document.getElementById("HiddenFieldSessionID");             var sessionId = Hidden.value;             window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;          }

    ```

     Teď, když víme, kde dochází k chybě a že musíme extrahovat hodnotu pro sessionId. Hodnota extrakce je však pouze text, takže musíme dále izolovat chybu pokusem o nalezení řetězce, kde je zobrazena skutečná hodnota sessionId. Při pohledu na kód, uvidíte, že var sessionId se rovná hodnotě vrácené HiddenFieldSessionID.

5. Použijte rychlé hledání na HiddenFieldSessionID, zrušení zaškrtnutí políčka hledání a výběr aktuálního požadavku.

     ![Použití rychlého hledání na HiddenFieldSession](../test/media/web_test_dynamicparameter_runresultsquckfindhiddensession.png)

     Všimněte si, že vrácená hodnota není stejný řetězec jako v původní záznam testu výkonu webu. Pro tento test spustit, vrácená hodnota je "5w4v3yrse4wa4axrafykqksq" a v původním záznamu, hodnota je "1v0yhyiyr0raa2w4j4pwf5zl". Vzhledem k tomu, že hodnota neodpovídá původní záznam, je generována chyba.

6. Protože musíme opravit dynamický parametr v původním záznamu, zvolte zaznamenaný výsledek v panelu nástrojů.

     ![Výběr zaznamenaného výsledku](../test/media/web_test_dynamicparameter_recordedresult.png)

7. V zaznamenaných výsledcích vyberte třetí požadavek, což je stejný požadavek *Querystringrequest.aspx,* který jste izolovali ve výsledcích spuštění testu.

     ![Vyberte stejný požadavek v zaznamenaných výsledcích](../test/media/web_test_dynamicparameter_recordedresultsselectnode.png)

     Zvolte kartu odpovědi, posuňte se dolů a zvolte původní hodnotu dynamického parametru "1v0yhyiyr0raa2w4j4pwf5zl", kterou jste dříve izolovali, a přidejte pravidlo extrakce.

     ![Přidání pravidla extrakce pro dynamický parametr](../test/media/web_test_dynamicparameter_recordedresultaddextractionrule.png)

     Nové pravidlo extrakce je přidáno do požadavku *Querystring.aspx* a je mu přiřazena hodnota "Param0".

     Pokud nás dialogové okno informuje, že byly nalezeny shody extrahovaného textu, na který se má parametr svázat, zvolte **Ano**.

     ![Pravidlo extrakce bylo vytvořeno.](../test/media/web_test_dynamicparameter_addextractiondialog.png)

8. Zvolte **Najít další**. První shoda je ten, který musíme změnit, což je parametr pro CustomQueryString v pro stránku JScriptQuery.

     ![Vyhledání a nahrazení textu parametru](../test/media/web_test_dynamicparameter_addextractionfindreplace.png)

9. Zvolte **Nahradit**.

     ![Nahrazení textu parametrem](../test/media/web_test_dynamicparameter_addextractionfindreplace2.png)

     Parametr QueryString v rámci požadavku *JScriptQuery.aspx* je aktualizován pomocí nového parametru context: CustomQueryString=jScriptQueryString___{{Param0}}.

     ![Parametr použitý na řetězec dotazu](../test/media/web_test_dynamicparameter_addextractionfindreplace3.png)

10. Zavřete dialogové okno **Najít a nahradit.** Všimněte si podobné struktury ve stromu požadavků mezi zjištěným dynamickým parametrem a nezjištěným dynamickým parametrem, který jste korelovali.

     ![Zjištěné a korelované dynamické parametry](../test/media/web_test_dynamicparameter_conclusion.png)

11. Spusťte test. Nyní běží bez selhání.

## <a name="qa"></a>Q&A

### <a name="q-can-i-re-run-dynamic-parameter-detection-if-my-web-app-gets-modified"></a>Otázka: Mohu znovu spustit detekci dynamických parametrů, pokud se moje webová aplikace změní?

**A:** Ano, použijte následující postup:

1. Na panelu nástrojů zvolte tlačítko **Povýšit dynamické parametry na parametry webového testu.**

     Po dokončení procesu zjišťování se po zjištění dynamických parametrů zobrazí dialogové okno **Povýšit dynamické parametry na parametry webového testu.**

     Dynamické parametry jsou uvedeny ve sloupci Dynamické parametry. Požadavky, které dynamický parametr budou extrahovány z a vázány jsou uvedeny v extract Parametr from Response a Bind to Request sloupce.

     Pokud zvolíte dynamický parametr v dialogovém okně **Povýšit dynamické parametry na parametry webového testu,** budou ve stromu požadavků editoru testů výkonu webu zvýrazněny dva požadavky. První požadavek bude požadavek, že pravidlo extrakce bude přidáno. Druhý požadavek je, kde extrahované hodnoty bude vázána.

2. Zaškrtněte nebo zrušte zaškrtnutí políčka vedle dynamických parametrů, které chcete automaticky korelovat. Ve výchozím nastavení jsou kontrolovány všechny dynamické parametry.

### <a name="q-do-i-need-to-configure-visual-studio-to-detect-dynamic-parameters"></a>Otázka: Je nutné nakonfigurovat Visual Studio pro detekci dynamických parametrů?

**A:** Výchozí konfigurace sady Visual Studio je pro detekci dynamických parametrů při záznamu testu výkonu webu. Pokud však máte možnosti sady Visual Studio nakonfigurované tak, aby nezjišťovaly dynamické parametry, nebo testovaná webová aplikace bude změněna o další dynamické parametry. Stále můžete spustit dynamické zjišťování parametrů z Editoru testů výkonnosti webu.
